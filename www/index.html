<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!-- Consider adding an manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <!-- Use the .htaccess and remove these lines to avoid edge case issues.
       More info: h5bp.com/b/378 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>ami-generator</title>
  <meta name="description" content="amigen demo site">
  <meta name="author" content="Steven Campbell">

  <!-- Mobile viewport optimized: j.mp/bplateviewport -->
  <meta name="viewport" content="width=1020,initial-scale=1">

  <!-- Place favicon.ico and apple-touch-icon.png in the root directory: mathiasbynens.be/notes/touch-icons -->

  <!-- CSS: implied media=all -->
  <!-- CSS concatenated and minified via ant build script-->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/prettify.css">
  <!-- end CSS-->
  <link rel="stylesheet" href="css/bootstrap.min.css">
	
  <!-- More ideas for your <head> here: h5bp.com/d/head-Tips -->

  <!-- All JavaScript at the bottom, except for Modernizr / Respond.
       Modernizr enables HTML5 elements & feature detects; Respond is a polyfill for min/max-width CSS3 Media Queries
       For optimal performance, use a custom Modernizr build: www.modernizr.com/download/ -->
  <script src="js/libs/modernizr-2.0.6.min.js"></script>
</head>

<body style="padding-top: 40px;">

	<div class="topbar">
		<div class="fill">
			<div class="container">
				<a class="brand" href="#">amigen</a>
				<ul class="nav">
					<li class="active"><a href="#gen">Generator</a></li>
					<li><a href="#about1">About amigen</a></li>
					<li><a href="#about2">About this page</a></li>
				</ul>
				<!--
				<form action="" class="pull-right">
					<input class="input-small" type="text" placeholder="Username">
					<input class="input-small" type="password" placeholder="Password">
					<button class="btn" type="submit">Sign in</button>
				</form>
				-->
			</div>
		</div>
	</div>

	<div class="container">

		<div class="content">
			<div class="page-header" id="gen">
				<h1>ami-generator <small>Generation of Amazon EC2 images</small></h1>
			</div>
			<p>All images generated by this tool are 64-bit Linux "t1.micro" machines, suitable for running on the <a href="http://aws.amazon.com/free/" target="_blank">AWS Free Usage Tier</a>.  User name for the <a href="http://en.wikipedia.org/wiki/Ubuntu_(operating_system)" target="_blank">Ubuntu</a> images is "ubuntu", and for the other images is "ec2-user".  There is a <code>readme.txt</code> in the home folder of each image explaining how to get started with the installed software.</p>
			<div class="alert-message error hide fade in" id="serviceDown">Looks like the service is down.  The tool page aint gonna work until its up again!  Please try again later.</div>
			<div class="alert-message success hide fade in" id="imageSuccess">Your image <a target="_blank" href="" id="amiLink"></a> is ready!  Click on the AMI id to launch it.</div>
			<div class="pleaseWait alert-message info hide fade in">Please wait...depending on your choices it may take up to 1 hour.  You can do other stuff on this page - it won't cancel your image.</div>
			<form>
				<fieldset>
					<legend>Construct your image</legend>
					<div class="clearfix">
						<label for="distro">Linux distribution</label>
						<div class="input">
							<select class="medium" name="distro" id="distro">
							
							</select>
						</div>
						
					</div>
					<div class="clearfix" id="amiScriptsDiv">
						<label for="amiScripts">One or more scripts</label>
						<div class="input">
							<select class="xlarge" size="10" multiple="multiple" name="amiScripts" id="amiScripts">
							
							</select>
							<span class="help-inline">Select at least one script</span>
						</div>
						<hidden id="allScripts"></hidden>
						
					</div>
					<div class="clearfix">
						<label for="region">AWS region</label>
						<div class="input">
							<select class="medium" name="region" id="region">
								
							</select>
							<span class="help-inline">us-east-1 is the cheapest</span>
						</div>
					</div>
					<div class="clearfix hide">
						<label for="bitNess">Platform</label>
						<div class="input">
							<ul class="inputs-list">
								<li>
									<label>
										<input type="radio" id="optionsRadios" name="optionsRadios" value="32bit">			
										<span>32 bit - only choose if you want to run a Small (m1.small) or High-CPU Medium (c1.medium) Instance</span>										
									</label>
								</li>
								<li>
									<label>
										<input type="radio" id="optionsRadios" checked name="optionsRadios" value="64bit">										
										<span>64 bit - works best for most instance sizes</span>										
									</label>
								</li>
							</ul>
						</div>
					</div>
					<div class="actions">
						<input type="button" class="btn primary" id="btnCreate" name="btnCreate" value="Create Image Now">
						<img src="img/ajax-loader.gif" width="16" height="16" class="pleaseWait hide"/>
					</div>
				</fieldset>
			</form>
			<p />
			<div class="container" id="about1">
				<h1>About ami-generator <small></small></h1>
				<p>The app came into being because of my own need to find trustworthy Linux images with the software I needed.  It is easy to find a good base image,
				but the manual steps to get things working securely and well were burdensome. So I created this app which generates an image to the spec that I want.
				</p>
				<p>In addition to working software, it was important to me that the images be ready for Internet use, i.e. fully patched, hardened against hacking attacks.  All amigen images 
				install security updates daily, and are hardened against common attacks for the software they install.
				</p>
				<p>If there is software that you would like added, please let me know at <a href="mailto:ami-requests@perfectapi.com">ami-requests@perfectapi.com</a>.  The repository for this software together with the <a href="https://github.com/perfectapi/ami-generator/tree/master/scripts" target="_blank">scripts</a> is on Github - <a href="https://github.com/perfectapi/ami-generator" target="_blank">https://github.com/perfectapi/ami-generator</a>.</p>
				
			</div>
			<div class="container" id="about2">
				<h1>About this page <small></small></h1>
				<p>This page is static html5 hosted on Amazon S3 using <a href="http://docs.amazonwebservices.com/AmazonS3/latest/dev/WebsiteHosting.html" target="_blank">Amazon's guidelines</a>.  The reason that the page is able to have non-static functionality is that it uses <a href="https://github.com/perfectapi/node-perfectapi" target="_blank">PerfectAPI</a> to communicate with a service-backend on another server.  PerfectAPI is an API framework that API authors can use to expose their API to any platform (Javascript in this case).  There are 2 javascript calls on this page:
				<pre class="prettyprint">
perfectapi.callApi('scripts', function(err, data) {
  //populates select boxes with lists of distros and scripts
  ...
});</pre>
				and to generate the image (simplified):
				<pre class="prettyprint">
//get config from page
var config = {};
config.scripts = $('#amiScripts').val();
config.options = {};
config.options.region = $('#region').val();
config.options.publish = true;
		
perfectapi.callApi('gen', config, function(err, result) {
  //generates an image using the supplied config
  $('#amiLink').text(result.ami);
  $('#amiLink').attr("href", "https://console.aws.amazon.com/ec2/home?region=" + result.region + "#launchAmi=" + result.ami);
  $('#imageSuccess').show();
});</pre>
				</p>
				<p>This syntax for the remote procedure call (rpc) is the same as all PerfectAPIs - a command name (<code>gen</code> above), an optional <code>config</code>, and a callback function which will be executed when the command is done.  It does not matter how long the command takes (well, up to 24 hours) - using the magic of WebSockets it will never timeout.
				</p>

			</div>
						<!--
			<div class="row">
				<div class="span10">
					<h2>Main content</h2>
				</div>
				<div class="span4">
					<h3>Secondary content</h3>
				</div>
			</div>
			-->
			
		</div>

		<footer>
			<p>Copyright &copy; 2011 Perfect API LLC</p>
		</footer>

	</div> <!-- /container -->



  <!-- JavaScript at the bottom for fast page loading -->

  <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="js/libs/jquery-1.6.2.min.js"><\/script>')</script>

	<!--
	<script src="//localhost:3000/apis/jquery.perfectapi.js"></script>
	<script src="//localhost:3000/socket.io/socket.io.js"></script>
	-->
	<script src="//services.perfectapi.com:3000/apis/jquery.perfectapi.js"></script>
	<script src="//services.perfectapi.com:3000/socket.io/socket.io.js"></script>
	
  <!-- scripts concatenated and minified via ant build script-->
  <script defer src="js/plugins.js"></script>
  <script defer src="js/script.js?v=2"></script>
  <!-- end scripts-->

	<script src="js/libs/prettify.min.js"></script>

	
  <!-- Change UA-XXXXX-X to be your site's ID -->
  <script>
    window._gaq = [['_setAccount','UA-26123362-1'],['_trackPageview'],['_trackPageLoadTime']];
    Modernizr.load({
      load: ('https:' == location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js'
    });
  </script>


  <!-- Prompt IE 6 users to install Chrome Frame. Remove this if you want to support IE 6.
       chromium.org/developers/how-tos/chrome-frame-getting-started -->
  <!--[if lt IE 7 ]>
    <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
    <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
  <![endif]-->
  
</body>
</html>
